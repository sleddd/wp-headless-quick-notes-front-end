(this["webpackJsonpnice-alien-uwido"]=this["webpackJsonpnice-alien-uwido"]||[]).push([[0],{112:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},119:function(e,t,n){},120:function(e,t,n){},122:function(e,t,n){},123:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(57),r=n(35),i=n(12),o=n(37),l=n(142),s=(n(112),n(2)),d=function(e){return Object(s.jsx)("div",{id:"fullWidthBackground__".concat(e.id),className:"fullWidthBackground"})},u=n(10),j=function(e,t){for(var n=[],c=[],a=0,r=1;r<=e;r++)t>a?(r=0,c.push(0),a++):c.push(r),(7===c.length||r===e&&t<7)&&(n.push(c),c=[]);return n},b=function(e){var t=new Date(e),n=t.getMonth(),c=t.toLocaleString("default",{month:"long"}),a=t.getFullYear(),r=new Date(t.getFullYear(),t.getMonth(),1).getDay(),i=new Date(a,n+1,0).getDate();return{numericalMonth:n,monthName:c,weeks:j(i,r),firstDay:r,totalDays:i,year:a}},m=function(){return(new Date).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})},O=["January","February","March","April","May","June","July","August","September","October","November","December"];var p,h=function(e,t){var n=Object(c.useRef)(e);Object(c.useEffect)((function(){n.current=e}),[e]),Object(c.useEffect)((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t);return function(){return clearInterval(e)}}}),[t])},f=(n(114),function(e){var t=Object(c.useState)(),n=Object(u.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){r(m())}),[]),h((function(){r(m())}),1e4),Object(s.jsx)("p",{className:e.className,children:a})}),x=n(14),y=n(144),v=n(136),g=n(135),_={loggedIn:!1,user:void 0,loading:!1,error:void 0},I=Object(c.createContext)(_),w=Object(y.a)(p||(p=Object(x.a)(["\n  query getUser {\n    viewer {\n      id\n      databaseId\n      firstName\n      lastName\n      nicename\n      email\n      capabilities\n    }\n  }\n"])));function D(e){var t=e.children,n=Object(g.a)(w),c=n.data,a=n.loading,r=n.error,i=null===c||void 0===c?void 0:c.viewer,o={loggedIn:Boolean(i),user:i,loading:a,error:r};return Object(s.jsx)(I.Provider,{value:o,children:t})}var N,E,F=function(){return Object(c.useContext)(I)},k=n(59),T=Object(y.a)(N||(N=Object(x.a)(["\n\tmutation Logout {\n\t\tlogout(input: {}) {\n\t\t\tstatus\n\t\t}\n\t}\n"]))),S=function(e){var t=Object(k.a)(),n=F(),c=n.user,a=(n.loggedIn,Object(v.a)(T,{refetchQueries:[{query:w}]})),r=Object(u.a)(a,2),i=r[0];r[1];return Object(s.jsxs)("div",{id:"logoutForm",children:[Object(s.jsx)("h1",{children:"Hello ".concat(c?c.firstName:"","!")}),Object(s.jsx)("button",{onClick:function(e){e.preventDefault(),i(),t.clearStore(),window.location.reload()},children:"LOGOUT"})]})},J=Object(y.a)(E||(E=Object(x.a)(["\n  mutation logIn($login: String!, $password: String!) {\n    loginWithCookies(input: {login: $login, password: $password }) {\n      clientMutationId\n      status\n    }\n  }\n"])));function $(){var e=F().loggedIn,t=Object(v.a)(J,{refetchQueries:[{query:w}]}),n=Object(u.a)(t,2),c=n[0],a=n[1];a.data,a.query,a.loading,a.error;return Object(s.jsx)(D,{children:e?Object(s.jsx)(S,{}):Object(s.jsxs)("form",{id:"loginForm",method:"post",onSubmit:function(e){e.preventDefault();var t=new FormData(e.currentTarget),n=Object.fromEntries(t),a=n.username,r=n.password;c({variables:{login:a,password:r}}).catch((function(e){console.error(e)}))},children:[Object(s.jsx)("h1",{children:"Login"}),Object(s.jsx)("label",{children:"Username:"}),Object(s.jsx)("input",{type:"text",name:"username",id:"username",autoComplete:"username"}),Object(s.jsx)("label",{children:"Password:"}),Object(s.jsx)("input",{type:"password",name:"password",id:"password",autoComplete:"password"}),Object(s.jsx)("input",{type:"submit"})]})})}n(115);var C,A,M,P,U,H=function(e){return Object(s.jsx)("div",{id:"menu",className:"menu ".concat(e.className),children:Object(s.jsx)($,{})})},L=function(e,t){var n=Object(c.useState)(e),a=Object(u.a)(n,2),r=a[0],i=a[1],o=Object(c.useCallback)((function(){return i(t[r])}));return[r,o,t]},q=(n(116),function(){var e=L("closed",{open:"closed",closed:"open"}),t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(s.jsxs)(c.Fragment,{children:[Object(s.jsxs)("div",{className:"navbar",children:[Object(s.jsx)(r.b,{to:"/",children:Object(s.jsx)(f,{className:"clock"})}),Object(s.jsxs)("div",{className:"hamburger ".concat(n),onClick:a,children:[Object(s.jsx)("div",{}),Object(s.jsx)("div",{}),Object(s.jsx)("div",{})]})]}),Object(s.jsx)(H,{className:n})]})}),R=function(e){var t=(new Date).toLocaleDateString("en-US")==e.month+"/"+e.day+"/"+e.year?"calendar__current-day":"";return Object(s.jsx)("td",{className:t,children:Object(s.jsx)(r.b,{to:"/calendar/".concat(e.month,"/").concat(e.day,"/").concat(e.year),children:e.day<1?"":e.day})})},Q=function(e){return Object(s.jsx)("tr",{children:e.week.map((function(t,n){return Object(s.jsx)(R,{day:t,month:e.month,year:e.year},n+t)}))})},B=n(55),V=(n(119),function(e){var t=Object(o.b)(),n=Object(o.c)((function(e){return e.ui.calendar}));Object(c.useEffect)((function(){t({type:"UPDATE_CALENDAR",calendarMonth:n})}),[]);var a=function(e){var c=n.numericalMonth,a=n.year;(n.numericalMonth>=1||n.numericalMonth<=12)&&(c="previous"===e?c--:c+2),0===c&&(c=12,a--),13===c&&(c=1,a++),t({type:"UPDATE_CALENDAR",calendarMonth:b(new Date(c+"/01/"+a).toString())})};return Object(s.jsx)("div",{className:"calendar",children:Object(s.jsxs)("table",{children:[Object(s.jsxs)("thead",{children:[Object(s.jsx)("tr",{children:Object(s.jsx)("th",{colSpan:7,children:Object(s.jsxs)("div",{className:"calendar__title",children:[Object(s.jsx)(B.IconPickerItem,{icon:"FaAngleLeft",size:20,color:"#fff",onClick:function(){a("previous")}}),Object(s.jsxs)("div",{children:[n.monthName," ",n.year]}),Object(s.jsx)(B.IconPickerItem,{icon:"FaAngleRight",size:20,color:"#fff",onClick:function(){a("next")}})]})})}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Sun"}),Object(s.jsx)("th",{children:"Mon"}),Object(s.jsx)("th",{children:"Tues"}),Object(s.jsx)("th",{children:"Weds"}),Object(s.jsx)("th",{children:"Thurs"}),Object(s.jsx)("th",{children:"Fri"}),Object(s.jsx)("th",{children:"Sat"})]})]}),Object(s.jsx)("tbody",{onClick:e.handler,children:n.weeks.map((function(e){return Object(s.jsx)(Q,{week:e,month:n.numericalMonth+1,year:n.year},e.join(""))}))})]})})}),W=(n(120),function(e){return Object(s.jsxs)(c.Fragment,{children:[Object(s.jsx)(d,{id:"main"}),Object(s.jsx)(q,{}),Object(s.jsx)("div",{className:"home",children:Object(s.jsx)(V,{})})]})}),K=n(25),Y=n(143),z=n(62),G={getTopics:Object(y.a)(C||(C=Object(x.a)(["query {\n  topics {\n    nodes {\n      customFields {\n        journalTopicFieldColor\n        journalTopicFieldIcon\n      }\n      name\n      id\n      topicId\n    }\n  }\n}"]))),getJournalByDate:Object(y.a)(A||(A=Object(x.a)(["\n  query Journal($month: Int!, $day: Int!, $year: Int!, $author: Int! ){\n    journals(first: 1000, where: {author: $author, status: PRIVATE, dateQuery: {month: $month, day: $day, year: $year}}) {\n      nodes {\n        id\n        journalId\n        title\n        customFields {\n          journalEntryFieldTitle\n          journalEntryFieldImage {\n            mediaItemUrl\n          }\n        }\n        topics {\n          nodes {\n            id\n            topicId\n            name\n            customFields {\n              journalTopicFieldColor\n              journalTopicFieldIcon\n            }\n          }\n        }\n      }\n    }\n  }\n"])))},X={createJournal:Object(y.a)(M||(M=Object(x.a)(["\nmutation MyMutation( $journal_entry_field_title: String!, $topicId: ID!, $title: String!) {\n  createJournal(\n    input: {journal_entry_field_title: $journal_entry_field_title, topics: {nodes: {id: $topicId }}, title: $title, status: PRIVATE}\n  ) {\n    journal {\n      id\n      journalId\n      title\n      customFields {\n        journalEntryFieldTitle\n        journalEntryFieldImage {\n          mediaItemUrl\n        }\n      }\n      topics {\n        nodes {\n          id\n          topicId\n          name\n          customFields {\n            journalTopicFieldColor\n            journalTopicFieldIcon\n          }\n        }\n      }\n    }\n  }\n}"]))),updateJournal:Object(y.a)(P||(P=Object(x.a)(["\nmutation MyMutation($id: ID!, $journal_entry_field_title: String!, $topicId: ID!) {\n  updateJournal(\n    input: {id: $id, journal_entry_field_title: $journal_entry_field_title, topics: {append: false, nodes: {id: $topicId}}}\n  ) {\n    journal {\n      journalId\n    }\n  }\n}"]))),deleteJournal:Object(y.a)(U||(U=Object(x.a)(["mutation($id: ID!) {\n    deleteJournal(input: {id: $id}) {\n        deletedId\n      }\n}"])))},Z=(n(81),function(e){var t=e.month,n=e.day,a=e.year,i=Object(o.b)(),l=b("".concat(t,"/").concat(n,"/").concat(a)),d=b("".concat(t-1,"/").concat(n,"/").concat(a)),u=1==n?d.totalDays:n-1,j=n==l.totalDays?1:n+1,m=1==n?t-1:t,p=n==l.totalDays?t+1:t,h=1==t?a-1:a,f=12==t?a+1:a;return Object(c.useEffect)((function(){i({type:"UPDATE_CALENDAR",calendarMonth:l})}),[t]),Object(s.jsxs)("ul",{className:"dayNav",children:[Object(s.jsx)("li",{children:Object(s.jsx)(r.b,{to:"/calendar/".concat(m,"/").concat(u,"/").concat(h),children:" \xab Prev"})}),Object(s.jsx)("li",{children:Object(s.jsx)(r.b,{to:"/calendar",children:Object(s.jsxs)("h1",{children:[O[t-1]," ",n,", ",a]})})}),Object(s.jsx)("li",{children:Object(s.jsx)(r.b,{to:"/calendar/".concat(p,"/").concat(j,"/").concat(f),children:"Next \xbb"})})]})}),ee=(n(122),Object(z.a)(Object(Y.a)(G.getTopics,{name:"topicQuery"}))((function(e){var t=L("closed",{open:"closed",closed:"open"}),n=Object(u.a)(t,2),a=n[0],r=n[1],i=Object(c.useState)([]),o=Object(u.a)(i,2),l=o[0],d=o[1],j=Object(c.useState)(e.currentTopic),b=Object(u.a)(j,2),m=b[0],O=b[1];Object(c.useEffect)((function(){var t=e.topicQuery.topics?Object(K.a)(e.topicQuery.topics.nodes):[];t.sort((function(e,t){return e.id===m?-1:0})),d(t)}),[e.topicQuery]);var p=function(e){var t=Object(K.a)(l);t.sort((function(t,n){return t.customFields.journalTopicFieldIcon===e?(O(t.id),-1):0})),d(t)};return Object(s.jsxs)("div",{className:"topicPicker",onClick:r,children:[Object(s.jsx)("input",{className:"topicPicker__selected-topic",type:"hidden",value:m}),Object(s.jsx)("div",{className:"topicPicker__topic",children:Object(s.jsx)("div",{className:"topicPicker__topic__options ".concat(a),children:l.map((function(e,t){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(B.IconPickerItem,{icon:e.customFields.journalTopicFieldIcon,size:24,color:e.customFields.journalTopicFieldColor,onClick:p}),Object(s.jsx)("input",{type:"hidden",value:e.id})]})}))})})]})}))),te=n(61),ne=function(e){var t=e.id,n=e.journalId,c=e.topicId,a=e.title,r=e.deleteItemHandler,i=e.onEnterHandler,o=F(),l=o.user,d=o.loggedIn;return Object(s.jsx)(s.Fragment,{children:d&&l&&-1!=l.capabilities.indexOf("edit_posts")&&Object(s.jsxs)("li",{className:"journal__item",children:[Object(s.jsx)("div",{className:"journal__item__topic",children:Object(s.jsx)(ee,{pickerKey:"item-".concat(n,"-").concat(c),currentTopic:c},"item-".concat(n,"-").concat(c))}),Object(s.jsxs)("div",{className:"journal__item__entry",children:[Object(s.jsx)(te.a,{id:"item-title-".concat(n),className:"grow-wrap",rows:"1",defaultValue:a,onKeyUp:i}),Object(s.jsx)("input",{id:"item-id-".concat(n),type:"hidden",value:t})]}),Object(s.jsx)("input",{className:"journal__item__remove",type:"checkbox",value:t,id:"item-remove-".concat(n),onChange:r})]})})},ce=function(e){return Object(s.jsxs)("li",{className:"journal__item",children:[Object(s.jsx)("div",{className:"journal__item__topic",children:Object(s.jsx)(ee,{currentTopic:"dGVybTo4"},"new-entry-topic-picker")}),Object(s.jsxs)("div",{className:"journal__item__entry",children:[Object(s.jsx)(te.a,{id:"item-title-new-entry",rows:"1",defaultValue:"",placeholder:"Enter title",onKeyUp:e.onEnterHandler}),Object(s.jsx)("input",{id:"item-id-new-entry",type:"hidden",value:""})]})]},"new-entry-item")},ae=(n(123),function(e){return Object(s.jsxs)("ul",{className:"journal",children:[e.journal.map((function(t){return Object(s.jsx)(ne,{id:t.id,journalId:t.journalId,title:t.customFields.journalEntryFieldTitle,topicId:t.topics.nodes[0].id,deleteItemHandler:e.deleteItemHandler,onEnterHandler:e.onEnterHandler},"journalItem-".concat(t.id))})),Object(s.jsx)(ce,{onEnterHandler:e.onEnterHandler})]})}),re=Object(z.a)(Object(Y.a)(X.updateJournal,{name:"updateJournal"}),Object(Y.a)(X.createJournal,{name:"createJournal"}),Object(Y.a)(X.deleteJournal,{name:"deleteJournal"}))((function(e){var t=e.updateJournal,n=e.createJournal,a=e.deleteJournal,r=e.match.params,i=r.day,o=r.month,l=r.year,u=F(),j=u.user,b=u.loggedIn,m=j?j.databaseId:0,O=Object(g.a)(G.getJournalByDate,{variables:{month:parseInt(o),day:parseInt(i),year:parseInt(l),author:parseInt(m)}}),p=O.data&&O.data.journals?O.data.journals.nodes:[];Object(c.useEffect)((function(){O.refetch()}),[n,t,a]);var h=function(e){e.preventDefault();var c=document.querySelectorAll("li"),a=[];c.forEach((function(e){var t=e.querySelectorAll("textarea"),n=e.querySelectorAll("input"),c=[].concat(Object(K.a)(t),Object(K.a)(n)),r="",i="",o="dGVybToy",l=null,s=null;c.forEach((function(e){-1!=e.id.indexOf("item-title")&&(i=e.value,l=e),-1!=e.id.indexOf("item-id")&&(r=e.value,s=e),e.classList.contains("topicPicker__selected-topic")&&(o=e.value)})),a.push({id:r,title:i.trim(),topicId:o,idElement:s,titleElement:l})})),a.forEach((function(e){b&&j&&-1!=j.capabilities.indexOf("edit_private_posts")?e.id.length>1?(t({variables:{id:e.id,topicId:e.topicId,journal_entry_field_title:e.title.trim()}}),O.refetch()):e.title.length>1&&(n({variables:{journal_entry_field_title:e.title.trim(),topicId:e.topicId,title:"Journal Item Dated ".concat(new Date)},update:function(e,t){var n=t.data;O.refetch(),p=O.data&&O.data.journals?O.data.journals.nodes:[],e.writeQuery({query:G.getJournalByDate,data:{journals:{nodes:[].concat(Object(K.a)(p),[n.createJournal.journal])}}})}}),e.idElement.value="",e.titleElement.value=""):alert("You must be logged in to add new items.")}))};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(d,{id:"main"}),Object(s.jsx)(q,{}),Object(s.jsxs)("form",{id:"dayForm",className:"day",method:"post",onSubmit:h,autoComplete:"off",children:[Object(s.jsx)(Z,{month:parseInt(o),day:parseInt(i),year:l}),Object(s.jsx)(ae,{journal:p,deleteItemHandler:function(e){b&&j&&-1!=j.capabilities.indexOf("edit_posts")?(a({variables:{id:e.target.value}}),O.refetch()):alert("You must be logged in to add new items.")},onEnterHandler:function(e){e.preventDefault(),13==e.keyCode&&0==e.shiftKey&&(e.preventDefault(),h(e))}}),Object(s.jsx)("input",{type:"submit",value:"Submit"})]})]})})),ie=n(43),oe=n(92),le=n(93),se={calendar:b((new Date).toString())},de=Object(ie.combineReducers)({ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);if("UPDATE_CALENDAR"===t.type)n.calendar=t.calendarMonth;return n}}),ue=Object(le.composeWithDevTools)(Object(ie.applyMiddleware)(oe.a)),je=Object(ie.createStore)(de,ue);je.subscribe((function(){}));var be=n(145),me=n(129),Oe=n(146),pe=new be.a({}),he=new Oe.a({uri:"https://admin.journal.local/graphql",credentials:"include"});n(124),n(125);function fe(){var e=new me.a({link:he,cache:pe});return Object(s.jsx)(l.a,{client:e,children:Object(s.jsx)(D,{children:Object(s.jsx)(o.a,{store:je,children:Object(s.jsx)(r.a,{children:Object(s.jsxs)(i.c,{children:[Object(s.jsx)(i.a,{path:"/calendar/:month/:day/:year",component:re}),Object(s.jsx)(i.a,{path:"/",component:W})]})})})})})}Object(a.render)(Object(s.jsx)(fe,{}),document.getElementById("root"))},81:function(e,t,n){}},[[126,1,2]]]);
//# sourceMappingURL=main.094340de.chunk.js.map